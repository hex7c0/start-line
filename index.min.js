/*
 * startline v1.3.5
 * (c) hex7c0 http://supergiovane.tk/#/startline
 * Licensed under GPLv3
 */
"use strict";function interfac(a,b,c){var d;return d=c>=0?fs.createReadStream(a.file,{flags:a.flag,mode:a.mode,encoding:a.encoding,autoClose:a.autoClose,start:b,end:c,fd:null}):fs.createReadStream(a.file,{flags:a.flag,mode:a.mode,encoding:a.encoding,autoClose:a.autoClose,start:b,fd:null})}function readlin(a,b,c){var d;return d=readline.createInterface({input:interfac(a,b,c),output:null,terminal:!1})}function STARTLINE(a){event.call(this);var b=this,c="";if(this.options=a,this.head=0,this.tail=0,this.line=0,this._stream,a.rc4||a.autokey){var d;this._stream=interfac(this.options,a.start,a.end),a.rc4?(d=require("arc4")(String(a.rc4),a.lodash),this._stream.on("data",function(a){for(var a=d.codeBuffer(a).toString(),e=0,f=a.length;f>e;e++)a[e]===eol?(b.tail=b.head+b.line,b.head=b.tail+c.length,b.emit("line",c),b.line=1,c=""):c+=a[e];c.length>0&&(b.tail=b.head+b.line,b.head=b.tail+c.length,b.emit("line",c),b.line=1)})):(d=require("autokey")(String(a.autokey),a.lodash),this._stream.on("data",function(a){for(var a=d.decodeBuffer(a).toString(),e=0,f=a.length;f>e;e++)a[e]===eol?(b.tail=b.head+b.line,b.head=b.tail+c.length,b.emit("line",c),b.line=1,c=""):c+=a[e];c.length>0&&(b.tail=b.head+b.line,b.head=b.tail+c.length,b.emit("line",c),b.line=1)}))}else a.end>=0?(this._stream=interfac(this.options,a.start,a.end),this._stream.on("data",function(a){for(var a=a.toString(),d=0,e=a.length;e>d;d++)a[d]===eol?(b.tail=b.head+b.line,b.head=b.tail+c.length,b.emit("line",c),b.line=1,c=""):c+=a[d];c.length>0&&(b.tail=b.head+b.line,b.head=b.tail+c.length,b.emit("line",c),b.line=1)})):(this._stream=readlin(this.options,a.start,a.end),this._stream.on("line",function(a){b.tail=b.head+b.line,b.head=b.tail+a.length,b.emit("line",a),b.line=1}));this._stream.on("pause",function(){b.emit("pause")}),this._stream.on("resume",function(){b.emit("resume")}),this._stream.on("open",function(a){b.emit("open",a)}),this._stream.on("close",function(){b.emit("close")}),this._stream.on("end",function(){b.emit("end")}),this._stream.on("error",function(a){b.emit("error",a)})}var fs=require("fs"),readline=require("readline"),event=require("events").EventEmitter,inherits=require("util").inherits,eol=require("os").EOL;module.exports=function(a){var a=a||Object.create(null);if(!Boolean(a.file)){var b='"file" is required';throw new Error(b)}var c=require("path").resolve(String(a.file));if(!fs.existsSync(c)){var b=c+" not exists";throw new Error(b)}var d={file:c,encoding:a.encoding,flag:String(a.flag||"r"),mode:Number(a.mode)||444,autoClose:0==a.autoClose?!1:!0,start:Number(a.start)||0,end:Number(a.end),rc4:a.rc4,autokey:a.autokey,lodash:Boolean(a.autokey)};return new STARTLINE(d)},inherits(STARTLINE,event),STARTLINE.prototype.pause=function(){this._stream.pause()},STARTLINE.prototype.resume=function(){this._stream.resume()},STARTLINE.prototype.read=function(a,b){var c=this.options;return c.start=Number(a)||0,c.end=Number(b),new STARTLINE(c)};
